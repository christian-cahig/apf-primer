
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.1. Anticipating generator injections</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2. Solving for the bus voltages" href="solve-bus-voltages.html" />
    <link rel="prev" title="2. The APF Procedure" href="main.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../landing.html">
   Overview
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../preliminaries/main.html">
   1. Preliminaries
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/bus-types-and-scalars.html">
     1.1. Bus types and scalars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/bus-indexing.html">
     1.2. Bus indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/connection-matrices.html">
     1.3. Connection matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/system-parameter-matrices.html">
     1.4. System parameter matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/state-variables-and-variants.html">
     1.5. State variables and variants
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/control-variables-and-load-profile.html">
     1.6. Control variables and load profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/net-nodal-injections.html">
     1.7. Net nodal injections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/power-flow-equations.html">
     1.8. Power flow equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/some-jacobians.html">
     1.9. Some Jacobians
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../preliminaries/problem-data.html">
     1.10. Problem data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="main.html">
   2. The APF Procedure
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.1. Anticipating generator injections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="solve-bus-voltages.html">
     2.2. Solving for the bus voltages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="refine-slack-injs.html">
     2.3. Refining slack-bus generator injections
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../remarks/main.html">
   3. Remarks
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <i>Powered by <a href="https://jupyterbook.org">Jupyter Book</a></i>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/apf-procedure/anticipate-injs.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/christian-cahig/apf-primer"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/christian-cahig/apf-primer/issues/new?title=Issue%20on%20page%20%2Fapf-procedure/anticipate-injs.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-method-of-lateef">
   2.1.1. The method of Lateef
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-method-of-jacobians">
   2.1.2. The method of Jacobians
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-power-factor-method">
   2.1.3. The power factor method
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Anticipating generator injections</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-method-of-lateef">
   2.1.1. The method of Lateef
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-method-of-jacobians">
   2.1.2. The method of Jacobians
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-power-factor-method">
   2.1.3. The power factor method
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="anticipating-generator-injections">
<span id="apf-prc-antic-injs"></span><h1><span class="section-number">2.1. </span>Anticipating generator injections<a class="headerlink" href="#anticipating-generator-injections" title="Permalink to this headline">¶</a></h1>
<p>We describe three methods for accomplishing the first stage of the APF procedure.
In the following, we use <span class="math notranslate nohighlight">\(\operatorname{ReLU} \! \left( \cdot \right)\)</span> as the shorthand for the operation <span class="math notranslate nohighlight">\(\max \left( 0, \cdot \right)\)</span> .
To avoid explicit summations and multiplying by <span class="math notranslate nohighlight">\(\boldsymbol{1}^{ \! \mathsf{T} }\)</span>,
we use <span class="math notranslate nohighlight">\(\operatorname{sum} \! \left( \cdot \right)\)</span> to denote the sum of all the elements in an array.</p>
<div class="section" id="the-method-of-lateef">
<span id="apf-prc-antic-injs-mol"></span><h2><span class="section-number">2.1.1. </span>The method of Lateef<a class="headerlink" href="#the-method-of-lateef" title="Permalink to this headline">¶</a></h2>
<p>Let the snapshot data <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> contain
generator injections,
<span class="math notranslate nohighlight">\(\widetilde{ \boldsymbol{p} }_{ \mathsf{g} } + j \widetilde{ \boldsymbol{q} }_{ \mathsf{g} }\)</span> ,
and
total system loss,
<span class="math notranslate nohighlight">\(\widetilde{ p }_{ \mathsf{l} } + j \widetilde{ q }_{ \mathsf{l} }\)</span> .
Let the dispatch data <span class="math notranslate nohighlight">\(\mathcal{D}\)</span> have
expected load draws,
<span class="math notranslate nohighlight">\(\boldsymbol{p}_{ \mathcal{d} } + j \boldsymbol{q}_{ \mathcal{d} }\)</span> ,
and
scheduled bounds on generator injections,
<span class="math notranslate nohighlight">\(\overline{ \boldsymbol{p} }_{ \mathsf{g} } + j \overline{ \boldsymbol{q} }_{ \mathsf{g} }\)</span> .</p>
<p>The change in total power draw is</p>
<div class="math notranslate nohighlight" id="equation-mol-change-total-d">
<span class="eqno">(2.1)<a class="headerlink" href="#equation-mol-change-total-d" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \Delta p_{ \mathsf{d} }
    &amp; =
    \operatorname{sum} \! \left( \boldsymbol{p}_{ \mathsf{d} } \right)
    -
    \operatorname{sum} \! \left( \widetilde{ \boldsymbol{p} }_{ \mathsf{g} } \right)
    +
    \widetilde{ p }_{ \mathsf{l} }
    \, , \\
    \Delta q_{ \mathsf{d} }
    &amp; =
    \operatorname{sum} \! \left( \boldsymbol{q}_{ \mathsf{d} } \right)
    -
    \operatorname{sum} \! \left( \widetilde{ \boldsymbol{q} }_{ \mathsf{g} } \right)
    +
    \widetilde{ q }_{ \mathsf{l} }
    \, .
\end{aligned}\end{split}\]</div>
<p>The anticipated changes in the total generator injections can then be approximated <em>naively</em> as</p>
<div class="math notranslate nohighlight" id="equation-mol-change-in-sum-c-naive">
<span class="eqno">(2.2)<a class="headerlink" href="#equation-mol-change-in-sum-c-naive" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \Delta p_{ \mathsf{g} }
    &amp; \approx
    \Delta p_{ \mathsf{d} }
    +
    \widetilde{ p }_{ \mathsf{l} }
    \, , \\
    \Delta q_{ \mathsf{g} }
    &amp; \approx
    \Delta q_{ \mathsf{d} }
    +
    \widetilde{ q }_{ \mathsf{l} }
    \, ,
\end{aligned}\end{split}\]</div>
<p>where the addition of the previous-snapshot loss acts as a heuristic buffer,
that is,
a change in total demand does not imply the same change in the required total supply.
A <em>conservative</em> approach would be to at least maintain the total supply, <em>i.e.</em>,</p>
<div class="math notranslate nohighlight" id="equation-mol-change-in-sum-c-conserv">
<span class="eqno">(2.3)<a class="headerlink" href="#equation-mol-change-in-sum-c-conserv" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \Delta p_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ReLU} \! \left(
        \Delta p_{ \mathsf{d} }
        +
        \widetilde{ p }_{ \mathsf{l} }
    \right)
    \, , \\
    \Delta q_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ReLU} \! \left(
        \Delta q_{ \mathsf{d} }
        +
        \widetilde{ q }_{ \mathsf{l} }
    \right)
    \, .
\end{aligned}\end{split}\]</div>
<p>A <em>strictly-increasing</em> flavour of <a class="reference internal" href="#equation-mol-change-in-sum-c-naive">(2.2)</a> can even be used when it is certain that total demand will increase:</p>
<div class="math notranslate nohighlight" id="equation-mol-change-in-sum-c-strict">
<span class="eqno">(2.4)<a class="headerlink" href="#equation-mol-change-in-sum-c-strict" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \Delta p_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ReLU} \! \left(
        \Delta p_{ \mathsf{d} }
    \right)
    +
    \widetilde{ p }_{ \mathsf{l} }
    \, , \\
    \Delta q_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ReLU} \! \left(
        \Delta q_{ \mathsf{d} }
    \right)
    +
    \widetilde{ q }_{ \mathsf{l} }
    \, .
\end{aligned}\end{split}\]</div>
<p>Then the anticipated control variables are calculated as</p>
<div class="math notranslate nohighlight" id="equation-mol-anticipated-c">
<span class="eqno">(2.5)<a class="headerlink" href="#equation-mol-anticipated-c" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \boldsymbol{p}_{ \mathsf{g} }
    &amp; \approx
    \frac{ 
        \operatorname{sum} \! \left( \widetilde{ \boldsymbol{p} }_{ \mathsf{g} } \right)
        +
        \Delta p_{ \mathsf{g} }
    }{
        \operatorname{sum} \! \left( \overline{ \boldsymbol{p} }_{ \mathsf{g} } \right)
    }
    \thinspace
    \overline{\boldsymbol{p}}_{ \mathsf{g} }
    \, , \\
    \boldsymbol{q}_{ \mathsf{g} }
    &amp; \approx
    \frac{
        \operatorname{sum} \! \left( \widetilde{ \boldsymbol{q} }_{ \mathsf{g} } \right)
        +
        \Delta q_{ \mathsf{g} }
    }{
        \operatorname{sum} \! \left( \overline{ \boldsymbol{q} }_{ \mathsf{g} } \right)
    }
    \thinspace
    \overline{\boldsymbol{q}}_{ \mathsf{g} }
    \, . 
\end{aligned}\end{split}\]</div>
<p>Equation <a class="reference internal" href="#equation-mol-change-total-d">(2.1)</a> and the “distributing among the generator units in proportion to their scheduled capacities” in Equation <a class="reference internal" href="#equation-mol-anticipated-c">(2.5)</a>
are based on the experimental setup detailed in Section 2.4 of Omer Lateef’s dissertation,
<a class="reference external" href="http://hdl.handle.net/1853/63600"><em>Measurement-Based Parameter Estimation and Analysis of Power System</em></a>.</p>
</div>
<div class="section" id="the-method-of-jacobians">
<span id="apf-prc-antic-injs-moj"></span><h2><span class="section-number">2.1.2. </span>The method of Jacobians<a class="headerlink" href="#the-method-of-jacobians" title="Permalink to this headline">¶</a></h2>
<p>Suppose that the following are among the snapshot data <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>:</p>
<ul class="simple">
<li><p>bus voltage magnitudes, <span class="math notranslate nohighlight">\( \widetilde{ \boldsymbol{v} } \)</span> ,
and phase angles, <span class="math notranslate nohighlight">\( \widetilde{ \boldsymbol{\delta} } \)</span> ,</p></li>
<li><p>load draws, <span class="math notranslate nohighlight">\(\widetilde{ \boldsymbol{p} }_{ \mathsf{d} } + j \widetilde{ \boldsymbol{q} }_{ \mathsf{d} }\)</span> ,</p></li>
<li><p>generator injections, <span class="math notranslate nohighlight">\(\widetilde{ \boldsymbol{p} }_{ \mathsf{g} } + j \widetilde{ \boldsymbol{q} }_{ \mathsf{g} }\)</span> ,
and</p></li>
<li><p>total system loss, <span class="math notranslate nohighlight">\(\widetilde{ p }_{ \mathsf{l} } + j \widetilde{ q }_{ \mathsf{l} }\)</span> .</p></li>
</ul>
<p>As with <a class="reference internal" href="#apf-prc-antic-injs-mol"><span class="std std-ref">the method of Lateef</span></a>,
we assume that the
expected load draws,
<span class="math notranslate nohighlight">\(\boldsymbol{p}_{ \mathcal{d} } + j \boldsymbol{q}_{ \mathcal{d} }\)</span> ,
and
the scheduled bounds on generator injections,
<span class="math notranslate nohighlight">\(\overline{ \boldsymbol{p} }_{ \mathsf{g} } + j \overline{ \boldsymbol{q} }_{ \mathsf{g} }\)</span> ,
belong to the dispatch data <span class="math notranslate nohighlight">\(\mathcal{D}\)</span>.</p>
<p>Central to this method is the treatment of vector differences as approximate gradients.
Hence the change in the <a class="reference internal" href="../preliminaries/control-variables-and-load-profile.html#prelim-control-vars-and-load-profile-bus-level"><span class="std std-ref">bus-level aggregate of the load draws</span></a>
can be treated as the gradient w.r.t. <span class="math notranslate nohighlight">\(\boldsymbol{d}^{ \prime }\)</span>
of some scalar <span class="math notranslate nohighlight">\(\ell\)</span> evaluated at the snapshot measurements, <em>i.e.</em>,</p>
<div class="math notranslate nohighlight" id="equation-moj-change-d-prime">
<span class="eqno">(2.6)<a class="headerlink" href="#equation-moj-change-d-prime" title="Permalink to this equation">¶</a></span>\[\begin{split}\nabla_{ \! \boldsymbol{d}^{ \prime } } \ell \! \left( 
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
=
\partial_{ \! \boldsymbol{d}^{ \prime } }^{ \mathsf{T} } \ell \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\approx
\Delta \boldsymbol{d}^{ \prime }
\triangleq
\boldsymbol{d}^{ \prime }
-
\widetilde{ \boldsymbol{d} }^{ \prime }
=
\left[ \begin{matrix}
    \boldsymbol{C}_{ \mathsf{d} } \thinspace \boldsymbol{p}_{ \mathsf{d} } \, \\
    \boldsymbol{C}_{ \mathsf{d} } \thinspace \boldsymbol{q}_{ \mathsf{d} } \, \\
\end{matrix} \right]
-
\left[ \begin{matrix}
    \widetilde{ \boldsymbol{C} }_{ \mathsf{d} } \thinspace \widetilde{ \boldsymbol{p} }_{ \mathsf{d} } \, \\
    \widetilde{ \boldsymbol{C} }_{ \mathsf{d} } \thinspace \widetilde{ \boldsymbol{q} }_{ \mathsf{d} } \, \\
\end{matrix} \right]
\in \mathbb{R}^{2N} \, .\end{split}\]</div>
<p>From the power flow equations, we can treat <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span> as an implicitly defined function of <span class="math notranslate nohighlight">\(\boldsymbol{d}^{ \prime }\)</span>.
Then, by the chain rule, we have</p>
<div class="math notranslate nohighlight">
\[
\nabla_{ \! \boldsymbol{d}^{ \prime } } \ell \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
=
\partial_{ \! \boldsymbol{d}^{ \prime } }^{ \mathsf{T} } \boldsymbol{s} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\,
\nabla_{ \! \boldsymbol{s} } \ell \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\, ,
\]</div>
<p>where the gradient w.r.t. <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span> is treated as the approximate change in <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span>
in response to the change in <span class="math notranslate nohighlight">\(\boldsymbol{d}^{ \prime }\)</span>,
<em>i.e.</em>,
<span class="math notranslate nohighlight">\(\nabla_{ \! \boldsymbol{s} } \ell \! \left( \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} } \right) \approx \Delta \boldsymbol{s}\)</span>.
Hence, we solve the square linear system</p>
<div class="math notranslate nohighlight" id="equation-moj-change-s">
<span class="eqno">(2.7)<a class="headerlink" href="#equation-moj-change-s" title="Permalink to this equation">¶</a></span>\[\partial_{ \! \boldsymbol{d}^{ \prime } }^{ \mathsf{T} } \boldsymbol{s} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\,
\Delta \boldsymbol{s}
=
\Delta \boldsymbol{d}^{\prime}
\, .\]</div>
<p>Now, the power flow equations also allow us to think of <span class="math notranslate nohighlight">\(\boldsymbol{c}\)</span>
as an implicitly defined function of <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span>.
We then have, by the chain rule,</p>
<div class="math notranslate nohighlight">
\[
\nabla_{ \! \boldsymbol{c} } \ell \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
=
\partial_{ \! \boldsymbol{c} }^{ \mathsf{T} } \boldsymbol{s} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\,
\nabla_{ \! \boldsymbol{s} } \ell \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\, .
\]</div>
<p>As before, the gradient w.r.t. <span class="math notranslate nohighlight">\(\boldsymbol{c}\)</span> is taken to be the approximate change in <span class="math notranslate nohighlight">\(\boldsymbol{c}\)</span>
in response to the change in <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span>,
leaving us with</p>
<div class="math notranslate nohighlight" id="equation-moj-change-c">
<span class="eqno">(2.8)<a class="headerlink" href="#equation-moj-change-c" title="Permalink to this equation">¶</a></span>\[\Delta \boldsymbol{c}
=
\partial_{ \! \boldsymbol{c} }^{ \mathsf{T} } \boldsymbol{s} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\,
\Delta \boldsymbol{s}
\, .\]</div>
<p>We discuss the coefficient matrix in Equation <a class="reference internal" href="#equation-moj-change-s">(2.7)</a> and the matrix multiplier in Equation <a class="reference internal" href="#equation-moj-change-c">(2.8)</a> later.</p>
<p>The “effective” approximate changes in the total generator injections will have “contributions” from <span class="math notranslate nohighlight">\(\Delta \boldsymbol{c}\)</span> and <span class="math notranslate nohighlight">\(\widetilde{ p }_{ \mathsf{l} } + j \widetilde{ q }_{ \mathsf{l} }\)</span>.
Then, in a manner similar to <a class="reference internal" href="#apf-prc-antic-injs-mol"><span class="std std-ref">the method of Lateef</span></a>,
the anticipated changes in total generator injections can be approximated <em>naively</em> as</p>
<div class="math notranslate nohighlight" id="equation-moj-change-in-sum-c-naive">
<span class="eqno">(2.9)<a class="headerlink" href="#equation-moj-change-in-sum-c-naive" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \Delta p_{ \mathsf{g} }
    &amp; \approx
    \operatorname{sum} \! \left( \Delta \boldsymbol{p}_{ \mathsf{g} } \right)
    +
    \widetilde{ p }_{ \mathsf{l} }
    \, , \\
    \Delta q_{ \mathsf{g} }
    &amp; \approx
    \operatorname{sum} \! \left( \Delta \boldsymbol{q}_{ \mathsf{g} } \right)
    +
    \widetilde{ q }_{ \mathsf{l} }
    \, , \\
\end{aligned}\end{split}\]</div>
<p><em>conservatively</em> as</p>
<div class="math notranslate nohighlight" id="equation-moj-change-in-sum-c-conserv">
<span class="eqno">(2.10)<a class="headerlink" href="#equation-moj-change-in-sum-c-conserv" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \Delta p_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ ReLU } \! \left(
        \operatorname{sum} \! \left( \Delta \boldsymbol{p}_{ \mathsf{g} } \right)
        +
        \widetilde{ p }_{ \mathsf{l} }
    \right)
    \, , \\
    \Delta q_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ ReLU } \! \left(
        \operatorname{sum} \! \left( \Delta \boldsymbol{q}_{ \mathsf{g} } \right)
        +
        \widetilde{ q }_{ \mathsf{l} }
    \right)
    \, , \\
\end{aligned}\end{split}\]</div>
<p>or in a <em>strictly increasing</em> manner as</p>
<div class="math notranslate nohighlight" id="equation-moj-change-in-sum-c-strict">
<span class="eqno">(2.11)<a class="headerlink" href="#equation-moj-change-in-sum-c-strict" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \Delta p_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ ReLU } \! \left(
        \operatorname{sum} \! \left( \Delta \boldsymbol{p}_{ \mathsf{g} } \right)
    \right)
    +
    \widetilde{ p }_{ \mathsf{l} }
    \, , \\
    \Delta q_{ \mathsf{g} }
    &amp; \approx
    \operatorname{ ReLU } \! \left(
        \operatorname{sum} \! \left( \Delta \boldsymbol{q}_{ \mathsf{g} } \right)
    \right)
    +
    \widetilde{ q }_{ \mathsf{l} }
    \, , \\
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta \boldsymbol{p}_{ \mathsf{g} }\)</span> and <span class="math notranslate nohighlight">\(\Delta \boldsymbol{q}_{ \mathsf{g} }\)</span>
are subvectors of <span class="math notranslate nohighlight">\(\Delta \boldsymbol{c}\)</span> <a class="reference internal" href="../preliminaries/control-variables-and-load-profile.html#equation-pg-qg-2-c">(1.21)</a>.
Then the anticipated control variables are calculated as</p>
<div class="math notranslate nohighlight" id="equation-moj-anticipated-c">
<span class="eqno">(2.12)<a class="headerlink" href="#equation-moj-anticipated-c" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \boldsymbol{p}_{ \mathsf{g} }
    &amp; \approx
    \frac{ 
        \operatorname{sum} \! \left( \widetilde{ \boldsymbol{p} }_{ \mathsf{g} } \right)
        +
        \Delta p_{ \mathsf{g} }
    }{
        \operatorname{sum} \! \left( \overline{ \boldsymbol{p} }_{ \mathsf{g} } \right)
    }
    \thinspace
    \overline{\boldsymbol{p}}_{ \mathsf{g} }
    \, , \\
    \boldsymbol{q}_{ \mathsf{g} }
    &amp; \approx
    \frac{
        \operatorname{sum} \! \left( \widetilde{ \boldsymbol{q} }_{ \mathsf{g} } \right)
        +
        \Delta q_{ \mathsf{g} }
    }{
        \operatorname{sum} \! \left( \overline{ \boldsymbol{q} }_{ \mathsf{g} } \right)
    }
    \thinspace
    \overline{\boldsymbol{q}}_{ \mathsf{g} }
    \, . 
\end{aligned}\end{split}\]</div>
<p>To calculate the Jacobian of <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span> w.r.t. <span class="math notranslate nohighlight">\(\boldsymbol{d}^{ \prime }\)</span>,
we can take the former to be an implicitly defined function solely of the latter
through the power flow equations, and invoke the implicit function theorem.
Evaluating this at the snapshot measurements, we have the linear matrix equation</p>
<div class="math notranslate nohighlight">
\[
\partial_{ \boldsymbol{s} } \boldsymbol{\phi} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\,
\partial_{ \boldsymbol{d}^{ \prime } } \boldsymbol{s} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
=
-
\partial_{ \boldsymbol{d}^{ \prime } } \boldsymbol{\phi} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\, .
\]</div>
<p>From Equation <a class="reference internal" href="../preliminaries/some-jacobians.html#equation-jac-phi-wrt-s">(1.39)</a>, the leftmost term is given by
<span class="math notranslate nohighlight">\(\partial_{ \boldsymbol{s} } \boldsymbol{e} \! \left( \widetilde{ \boldsymbol{s} } \right)\)</span>.
From Equation <a class="reference internal" href="../preliminaries/control-variables-and-load-profile.html#equation-d-prime">(1.24)</a> and <a class="reference internal" href="../preliminaries/power-flow-equations.html#equation-s-c-d-2-phi">(1.37)</a>, the Jacobian of <span class="math notranslate nohighlight">\(\boldsymbol{\phi}\)</span>
w.r.t. <span class="math notranslate nohighlight">\(\boldsymbol{d}^{ \prime }\)</span> is <span class="math notranslate nohighlight">\(\boldsymbol{I}_{ 2N }\)</span>.
Therefore, the above expression simplifies to</p>
<div class="math notranslate nohighlight" id="equation-jac-s-wrt-d-prime">
<span class="eqno">(2.13)<a class="headerlink" href="#equation-jac-s-wrt-d-prime" title="Permalink to this equation">¶</a></span>\[
\partial_{ \boldsymbol{s} } \boldsymbol{e} \! \left( \widetilde{ \boldsymbol{s} } \right)
\,
\partial_{ \boldsymbol{d}^{ \prime } } \boldsymbol{s} \! \left( \widetilde{ \boldsymbol{s} } \right)
=
- \boldsymbol{I}_{ 2N }
\, ,
\]</div>
<p>with which we can solve for
<span class="math notranslate nohighlight">\(\partial_{ \boldsymbol{d}^{ \prime } } \boldsymbol{s} \! \left( \widetilde{ \boldsymbol{s} } \right)\)</span>,
whose transpose is the desired coefficient matrix in Equation <a class="reference internal" href="#equation-moj-change-s">(2.7)</a>.</p>
<p>The Jacobian of <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span> w.r.t. <span class="math notranslate nohighlight">\(\boldsymbol{c}\)</span> also starts from interpreting the former
as an implicitly defined function solely of the latter, by virtue of the power flow equations.
Invoking the implicit function theorem and evaluating at the snapshot data,</p>
<div class="math notranslate nohighlight">
\[
\partial_{ \boldsymbol{s} } \boldsymbol{\phi} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\,
\partial_{ \boldsymbol{c} } \boldsymbol{s} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
=
-
\partial_{ \boldsymbol{c} } \boldsymbol{\phi} \! \left(
    \widetilde{ \boldsymbol{c} }, \widetilde{ \boldsymbol{d} }, \widetilde{ \boldsymbol{s} }
\right)
\, .
\]</div>
<p>We now know that the leftmost term is
<span class="math notranslate nohighlight">\(\partial_{ \boldsymbol{s} } \boldsymbol{e} \! \left( \widetilde{ \boldsymbol{s} } \right)\)</span>.
From Equation <a class="reference internal" href="../preliminaries/some-jacobians.html#equation-jac-phi-wrt-c">(1.40)</a>, the right-hand side term is
<span class="math notranslate nohighlight">\(\partial_{ \boldsymbol{c} } \boldsymbol{e}\)</span>.
The above linear matrix equation simplifies to</p>
<div class="math notranslate nohighlight" id="equation-jac-s-wrt-c">
<span class="eqno">(2.14)<a class="headerlink" href="#equation-jac-s-wrt-c" title="Permalink to this equation">¶</a></span>\[\begin{split}
\partial_{ \boldsymbol{s} } \boldsymbol{e} \! \left( \widetilde{ \boldsymbol{s} } \right)
\,
\partial_{ \boldsymbol{c} } \boldsymbol{s} \! \left( \widetilde{ \boldsymbol{s} } \right)
=
\partial_{ \boldsymbol{c} } \boldsymbol{e}
=
- \!
\left[ \begin{matrix}
    \boldsymbol{C}_{ \mathsf{g} }
    &amp;
    \boldsymbol{0}_{ N,G }          \, \\
    \boldsymbol{0}_{ N,G }
    &amp;
    \boldsymbol{C}_{ \mathsf{g} }   \, \\
\end{matrix} \right]
\, ,
\end{split}\]</div>
<p>from which we solve for
<span class="math notranslate nohighlight">\(\partial_{ \boldsymbol{c} } \boldsymbol{s} \! \left( \widetilde{ \boldsymbol{s} } \right)\)</span>,
whose transpose is the multiplier for <span class="math notranslate nohighlight">\(\Delta \boldsymbol{s}\)</span> in Equation <a class="reference internal" href="#equation-moj-change-c">(2.8)</a>.</p>
</div>
<div class="section" id="the-power-factor-method">
<span id="apf-prc-antic-injs-pfm"></span><h2><span class="section-number">2.1.3. </span>The power factor method<a class="headerlink" href="#the-power-factor-method" title="Permalink to this headline">¶</a></h2>
<p>Consider the case where a projected value of the total active generation,
<span class="math notranslate nohighlight">\(p_{ \mathsf{g} }\)</span> , is avaialble (<em>e.g.</em>, by a scheduling routine).
The anticipated active injections can be estimated by distributing <span class="math notranslate nohighlight">\(p_{ \mathsf{g} }\)</span>
among the generator units in proportion to the units’ scheduled limits,
<em>i.e.</em>,</p>
<div class="math notranslate nohighlight" id="equation-pfm-anticipated-pg">
<span class="eqno">(2.15)<a class="headerlink" href="#equation-pfm-anticipated-pg" title="Permalink to this equation">¶</a></span>\[\boldsymbol{p}_{ \mathsf{g} }
\approx
\frac{ p_{ \mathsf{g} } }{
    \operatorname{sum} \! \left( \overline{ \boldsymbol{p} }_{ \mathsf{g} } \right)
}
\thinspace
\overline{\boldsymbol{p}}_{ \mathsf{g} }
\, .\]</div>
<p>The anticipated total reactive generation <span class="math notranslate nohighlight">\(q_{ \mathsf{g} }\)</span> is estimated with the use of
the aggregate power factor at the previous snapshot, <em>i.e.</em>,</p>
<div class="math notranslate nohighlight" id="equation-pfm-anticipated-qg-sum">
<span class="eqno">(2.16)<a class="headerlink" href="#equation-pfm-anticipated-qg-sum" title="Permalink to this equation">¶</a></span>\[q_{ \mathsf{g} }
\approx
p_{ \mathsf{g} }
\tan \! \left( \operatorname{ arccos } \! \left( \operatorname{pf} \! \left(
    \operatorname{sum} \! \left(
        \widetilde{ \boldsymbol{p} }_{ \mathsf{g} }
        + j \widetilde{ \boldsymbol{q} }_{ \mathsf{g} }
    \right)
\right) \right) \right)
=
\frac{
    \operatorname{sum} \! \left( \widetilde{ \boldsymbol{q} }_{ \mathsf{g} } \right)
}{
    \operatorname{sum} \! \left( \widetilde{ \boldsymbol{p} }_{ \mathsf{g} } \right)
}
\thinspace
p_{ \mathsf{g} }
\, ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\operatorname{pf} \! \left( \cdot \right)\)</span> denotes the power factor of some complex power quantity.
Then the anticipated reactive injections are estimated as</p>
<div class="math notranslate nohighlight" id="equation-pfm-anticipated-qg">
<span class="eqno">(2.17)<a class="headerlink" href="#equation-pfm-anticipated-qg" title="Permalink to this equation">¶</a></span>\[\boldsymbol{q}_{ \mathsf{g} }
\approx
\frac{ q_{ \mathsf{g} } }{
    \operatorname{sum} \! \left( \overline{ \boldsymbol{q} }_{ \mathsf{g} } \right)
}
\thinspace
\overline{\boldsymbol{q}}_{ \mathsf{g} }
\, .\]</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./apf-procedure"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="main.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2. </span>The APF Procedure</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="solve-bus-voltages.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.2. </span>Solving for the bus voltages</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Christian Cahig<br/>
    
      <div class="extra_footer">
        <i>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a></i>.
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>